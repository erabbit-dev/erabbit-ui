import{c as w,I as y,m as O,o as T}from"./index.e6dd64ae.js";import{d as S,H as n,as as k,x as C,at as j,h as v,j as N,O as L,a6 as W,a2 as E,a3 as H,T as P,g as I,L as V}from"./framework.c01080b9.js";const $={type:{type:String,default:"default"},size:{type:String,default:"middle"},round:Boolean,disabled:Boolean,icon:String,circle:Boolean,loading:Boolean},[z,f]=w("button"),K=S({name:"ErButton",props:$,emit:["click"],setup(e,{slots:t}){const l=()=>{var s;const a=(s=t.default)==null?void 0:s.call(t);if(a)return n("span",{class:f("__text"),style:e.icon||e.loading?{paddingLeft:"5px"}:void 0},[a])},o=()=>{if(e.loading)return n(y,{name:"loading",class:f("__icon")},null);if(e.icon)return n(y,{name:e.icon,class:f("__icon")},null)};return()=>n("button",{class:[z,"ellipsis",f(e.size,e.type),e.round?"is-round":void 0,e.circle?"is-circle":void 0,e.disabled?f("disabled"):void 0,e.loading?f("loading"):void 0],disabled:e.disabled||e.loading},[o(),l()])}}),_=K;let m;const x=()=>typeof window<"u";function R(){var e;if(!x())return 0;if(m!==void 0)return m;const t=document.createElement("div");t.className="er-scrollbar__wrap",t.style.visibility="hidden",t.style.width="100px",t.style.position="absolute",t.style.top="-9999px",document.body.appendChild(t);const l=t.offsetWidth;t.style.overflow="scroll";const o=document.createElement("div");o.style.width="100%",t.appendChild(o);const s=o.offsetWidth;return(e=t.parentNode)==null||e.removeChild(t),m=l-s,m}const Y=e=>{const t="er-overflow-hidden";if(!k(e))throw new Error('useLockScroll: "trigger" must be a ref');if(!x()||document.body.classList.contains(t))return;let l=0,o=!1,s="0";const a=()=>{setTimeout(()=>{document.body.classList.remove(t),o&&document&&(document.body.style.width=s)},200)};C(e,r=>{var i;if(!r){a();return}o=!document.body.classList.contains(t),o&&(s=document.body.style.width),l=R();const u=document.documentElement.clientHeight<document.body.scrollHeight,d=(i=document.defaultView)==null?void 0:i.getComputedStyle(document.body).overflowY;l>0&&(u||d==="scroll")&&o&&(document.body.style.width=`calc(100% - ${l}px)`),document.body.classList.add(t)}),j(()=>a())};function D(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!H(e)}const[M,b]=w("confirm"),U={visible:Boolean,title:{type:String,default:""},message:{type:String,default:""},cancelText:{type:String,default:"Cancel"},submitText:{type:String,default:"OK"},teleport:{type:[String,Object],default:"body"},lockScroll:{type:Boolean,default:!0}},q=S({name:"ErConfirm",props:U,emits:["update:visible"],setup(e,{emit:t}){const l=v(!1),o=v(!1),s=v(null);C(()=>e.visible,c=>{c?r():a()}),N(()=>{e.visible&&r()});const a=()=>{o.value=!1,L(()=>{l.value=!1})},r=()=>{l.value=!0,setTimeout(()=>{o.value=!0},0)};W(s,()=>{t("update:visible",!1,"cancel")});const i=()=>{t("update:visible",!1,"cancel")},u=()=>{t("update:visible",!1,"submit")};e.lockScroll&&Y(o);const d=()=>n(P,{name:"popper"},{default:()=>[l.value?n("div",{class:["er-popper",M]},[n("div",{class:[b("__wrapper"),o.value?"active":""],ref:s},[n("div",{class:b("__header")},[n("h3",null,[e.title]),n(y,{name:"close",color:"#666",onClick:i},null)]),n("div",{class:b("__body")},[n(y,{name:"warn"},null),n("p",null,[e.message])]),n("div",{class:b("__footer")},[n(_,{onClick:i},{default:()=>[e.cancelText]}),n(_,{type:"primary",onClick:u},{default:()=>[e.submitText]})])])]):null]});return()=>{let c;return e.teleport?n(E,{to:e.teleport},D(c=d())?c:{default:()=>[c]}):d()}}}),B={title:"",message:"",cancelText:"Cancel",submitText:"OK",teleport:"body",lockScroll:!0};let p;const A=()=>{({instance:p}=O({setup(e,{expose:t}){const l=v({...B,visible:!1}),o=i=>{Object.assign(l.value,i,{visible:!0})},s=(i,u)=>{var d,c,h,g;u==="cancel"&&((c=(d=l.value).cancel)==null||c.call(d)),u==="submit"&&((g=(h=l.value).submit)==null||g.call(h)),l.value.visible=i};t({open:o});const r=I(()=>T(l.value,["submit","cancel"]));return()=>n(q,V(r.value,{"onUpdate:visible":s}),null)}}))},J=e=>new Promise((t,l)=>{p||A(),p.open({...Object.assign(B,e),submit:()=>{e.submit&&e.submit(),t("submit")},cancel:()=>{e.cancel&&e.cancel(),l("cancel")}})});export{_ as B,q as _,J as s};
